<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shop.nearby.nearbyshop.dao.BackDao">
<!--  分页查询超级管理的商铺数量-->
    <select id="findShopsByShop" resultType="com.shop.nearby.nearbyshop.model.Shop">
        select * from shopinfo where 1=1
        <if test="shop.mohu != null and shop.mohu !=''">
            AND concat(IFNULL(shopname,''),IFNULL(adminname,''),IFNULL(phonenum,'')
            ,IFNULL(code,'')) like  CONCAT('%',#{shop.mohu},'%')
        </if>
        LIMIT #{shop.from},#{shop.pageSize}
    </select>
<!--   查询超级管理员的商铺总数-->
    <select id="countShop" resultType="int">
        SELECT COUNT(*) FROM shopinfo  where 1=1
        <if test="shop.mohu != null and shop.mohu !=''">
            AND concat(IFNULL(shopname,''),IFNULL(adminname,''),IFNULL(phonenum,'')
            ,IFNULL(code,'')) like  CONCAT('%',#{shop.mohu},'%')
        </if>
    </select>
<!--   分页查询超级管理员的用户-->
    <select id="findWxUsersByUser" resultType="com.shop.nearby.nearbyshop.model.WxUser">
        select * from openids where isUser=1 and  1=1
        <if test="user.mohu != null and user.mohu !=''">
            AND concat(IFNULL(name,''),IFNULL(phonenum,''),IFNULL(address,'')
            ,IFNULL(province,''),IFNULL(city,''),IFNULL(county,'')) like  CONCAT('%',#{user.mohu},'%')
        </if>
        LIMIT #{user.from},#{user.pageSize}
    </select>
<!--查询超级管理员的用户数-->
    <select id="countWxUser" resultType="int">
        SELECT COUNT(*) FROM openids where isUser=1 and  1=1
        <if test="user.mohu != null and user.mohu !=''">
            AND concat(IFNULL(name,''),IFNULL(phonenum,''),IFNULL(address,'')
            ,IFNULL(province,''),IFNULL(city,''),IFNULL(county,'')) like  CONCAT('%',#{user.mohu},'%')
        </if>
    </select>
    <!--  分页查询超级管理的订单-->
    <select id="findShopsByBackOrder" resultType="com.shop.nearby.nearbyshop.model.BackOrder">
        SELECT o.time,o.status,o.money,o.num,ga.name username,ga.phonenum userphone,g.name goodsname,
        ga.province,ga.city,ga.county,ga.address
        FROM orders o,goodsaddress ga,goods g
        WHERE o.addressid=ga.id AND g.id=o.goodsid AND 1=1
        <if test="order.mohu != null and order.mohu !=''">
            AND concat(IFNULL(ga.name,''),IFNULL(ga.phonenum,''),IFNULL(g.name,'')) like CONCAT('%',#{order.mohu},'%')
        </if>
        LIMIT #{order.from},#{order.pageSize}
    </select>
    <!--   查询超级管理员的订单总数-->
    <select id="countBackOrder" resultType="int">
        select count(*)
        FROM orders o,goodsaddress ga,goods g
        WHERE o.addressid=ga.id AND g.id=o.goodsid AND 1=1
        <if test="order.mohu != null and order.mohu !=''">
            AND concat(IFNULL(ga.name,''),IFNULL(ga.phonenum,''),IFNULL(g.name,'')) like CONCAT('%',#{order.mohu},'%')
        </if>
    </select>
</mapper>